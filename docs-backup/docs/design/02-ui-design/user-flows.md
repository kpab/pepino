# ユーザーフロー

このページでは、Pepinoアプリケーションの主要なユーザーフローを定義します。

## 概要

ユーザーフローは、ユーザーがアプリケーション内でタスクを完了するまでの一連のステップを視覚化したものです。

## 主要ユーザーフロー

### 1. 初回利用フロー

```
アプリ起動
    ↓
オンボーディング画面
    ↓
位置情報許可リクエスト
    ↓ (許可)         ↓ (拒否)
現在地取得      →  手動位置設定
    ↓                  ↓
     ← ← ← ← ← ← ←
    ↓
メイン画面（イベント一覧）
```

### 2. イベント検索・参加フロー

```
メイン画面
    ↓
イベント一覧表示（現在地ベース）
    ↓
フィルター設定（オプション）
    ↓
イベント選択
    ↓
イベント詳細画面
    ↓
参加ボタン押下
    ↓
参加確認ダイアログ
    ↓ (確認)
参加完了
    ↓
カレンダー連携（オプション）
    ↓
アクセス案内表示
```

### 3. イベント作成フロー（主催者）

```
メイン画面
    ↓
「イベント作成」ボタン
    ↓
主催者認証（初回のみ）
    ↓
基本情報入力
- イベント名
- 説明
- カテゴリ
    ↓
日時設定
- 開始時刻
- 終了時刻
    ↓
場所設定
- 地図から選択 or 住所入力
    ↓
詳細設定
- 参加費
- 定員
- 持ち物
    ↓
プレビュー確認
    ↓
公開設定
    ↓
イベント作成完了
    ↓
共有オプション
```

### 4. 位置情報設定フロー

```
設定画面
    ↓
「位置情報設定」選択
    ↓
     現在の設定表示
    ↓
GPS利用 ⟷ 手動設定
    ↓ (GPS)          ↓ (手動)
位置情報許可確認   住所/地名入力
    ↓                 ↓
現在地取得         地図表示・選択
    ↓                 ↓
精度設定           確認
    ↓                 ↓
     ← ← ← ← ← ← ←
    ↓
設定保存・適用
```

## 詳細フロー図

### 検索フィルターフロー

```
メイン画面
    ↓
フィルターボタンタップ
    ↓
フィルター画面表示
├─ 距離設定（500m〜50km）
├─ 時間設定（今すぐ〜1週間後）
├─ カテゴリ選択（複数選択可）
├─ 参加費設定（無料〜上限設定）
└─ 参加者属性（年齢層、性別等）
    ↓
「適用」ボタン
    ↓
フィルター結果表示
    ↓
    結果なし → おすすめイベント表示
    結果あり → イベント一覧更新
```

### エラーハンドリングフロー

```
各種操作実行
    ↓
エラー発生
    ↓
エラー種別判定
├─ ネットワークエラー
│   └─ 再試行ダイアログ
├─ 位置情報エラー  
│   └─ 手動設定案内
├─ 認証エラー
│   └─ ログイン画面へ
└─ システムエラー
    └─ エラー報告画面
```

## モバイル特有のフロー

### プッシュ通知フロー

```
イベント参加完了
    ↓
通知許可リクエスト
    ↓ (許可)         ↓ (拒否)
通知設定画面      設定で後から変更可能
    ↓                 ↓
通知タイミング設定    ← ←
- 1時間前            
- 30分前             
- 開始時刻           
    ↓
設定完了
    ↓
（イベント当日）
    ↓
プッシュ通知送信
    ↓
通知タップ
    ↓
アプリ起動・イベント詳細表示
```

### オフライン対応フロー

```
ネットワーク切断検知
    ↓
オフラインモード切り替え
    ↓
キャッシュデータ表示
- 最近閲覧したイベント
- 参加予定イベント
    ↓
オンライン復帰検知
    ↓
データ同期
    ↓
最新情報反映
```

## パフォーマンス考慮事項

### 地図読み込みフロー

```
イベント詳細画面表示
    ↓
地図表示エリア確保
    ↓
Google Maps API読み込み
    ↓ (並行処理)
ローディング表示 ← → 地図データ取得
    ↓                    ↓
マーカー描画準備    ← ← ←
    ↓
地図表示完了
```

## ユーザビリティテストポイント

1. **初回利用**: オンボーディングの分かりやすさ
2. **検索効率**: 目的のイベントを見つけるまでの時間
3. **参加意欲**: 詳細画面から参加までの離脱率
4. **操作直感性**: 迷いなく操作できるか

[TODO: 実際のユーザーテスト結果を基に改善]
